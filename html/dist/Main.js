// Generated by psc version 0.6.1
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    var Unit = {
        create: function (value) {
            return value;
        }
    };
    function Semigroupoid($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    function Category(__superclass_Prelude$dotSemigroupoid_0, id) {
        this["__superclass_Prelude.Semigroupoid_0"] = __superclass_Prelude$dotSemigroupoid_0;
        this.id = id;
    };
    function Show(show) {
        this.show = show;
    };
    function Functor($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    function Apply($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    function Applicative(__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    function Bind($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    function Monad(__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    function Eq($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    function BoolLike($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    function Semigroup($less$greater) {
        this["<>"] = $less$greater;
    };
    function cons(e) {  return function(l) {    return [e].concat(l);  };};
    function showStringImpl(s) {  return JSON.stringify(s);};
    function showNumberImpl(n) {  return n.toString();};
    function showArrayImpl(f) {  return function(xs) {    var ss = [];    for (var i = 0, l = xs.length; i < l; i++) {      ss[i] = f(xs[i]);    }    return '[' + ss.join(',') + ']';  };};
    function refEq(r1) {  return function(r2) {    return r1 === r2;  };};
    function refIneq(r1) {  return function(r2) {    return r1 !== r2;  };};
    function boolAnd(b1) {  return function(b2) {    return b1 && b2;  };};
    function boolOr(b1) {  return function(b2) {    return b1 || b2;  };};
    function boolNot(b) {  return !b;};
    function concatString(s1) {  return function(s2) {    return s1 + s2;  };};
    var $bar$bar = function (dict) {
        return dict["||"];
    };
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $colon = cons;
    var $div$eq = function (dict) {
        return dict["/="];
    };
    var $plus$plus = function (__dict_Semigroup_2) {
        return $less$greater(__dict_Semigroup_2);
    };
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var unit = {};
    var showString = new Show(showStringImpl);
    var showNumber = new Show(showNumberImpl);
    var show = function (dict) {
        return dict.show;
    };
    var showArray = function (__dict_Show_3) {
        return new Show(showArrayImpl(show(__dict_Show_3)));
    };
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupString = new Semigroup(concatString);
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_5) {
        return pure(__dict_Monad_5["__superclass_Prelude.Applicative_0"]());
    };
    var liftA1 = function (__dict_Applicative_7) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_7["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_7)(f))(a);
            };
        };
    };
    var id = function (dict) {
        return dict.id;
    };
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqString = new Eq(refIneq, refEq);
    var eqNumber = new Eq(refIneq, refEq);
    var $$const = function (_26) {
        return function (_27) {
            return _26;
        };
    };
    var categoryArr = new Category(function () {
        return semigroupoidArr;
    }, function (x) {
        return x;
    });
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var ap = function (__dict_Monad_15) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_15["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_15)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        "$": $dollar, 
        "++": $plus$plus, 
        "/=": $div$eq, 
        ":": $colon, 
        "<$>": $less$dollar$greater, 
        "<*>": $less$times$greater, 
        "<<<": $less$less$less, 
        "<>": $less$greater, 
        "==": $eq$eq, 
        ">>=": $greater$greater$eq, 
        Applicative: Applicative, 
        Apply: Apply, 
        Bind: Bind, 
        BoolLike: BoolLike, 
        Category: Category, 
        Eq: Eq, 
        Functor: Functor, 
        Monad: Monad, 
        Semigroup: Semigroup, 
        Semigroupoid: Semigroupoid, 
        Show: Show, 
        Unit: Unit, 
        ap: ap, 
        boolLikeBoolean: boolLikeBoolean, 
        categoryArr: categoryArr, 
        cons: cons, 
        "const": $$const, 
        eqNumber: eqNumber, 
        eqString: eqString, 
        flip: flip, 
        id: id, 
        liftA1: liftA1, 
        pure: pure, 
        refEq: refEq, 
        refIneq: refIneq, 
        "return": $$return, 
        semigroupString: semigroupString, 
        semigroupoidArr: semigroupoidArr, 
        show: show, 
        showArray: showArray, 
        showNumber: showNumber, 
        showString: showString, 
        unit: unit, 
        "||": $bar$bar
    };
})();
var PS = PS || {};
PS.Data_Validation = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Invalid(value0) {
        this.value0 = value0;
    };
    Invalid.create = function (value0) {
        return new Invalid(value0);
    };
    function Valid(value0) {
        this.value0 = value0;
    };
    Valid.create = function (value0) {
        return new Valid(value0);
    };
    var runV = function (_47) {
        return function (_48) {
            return function (_49) {
                if (_49 instanceof Invalid) {
                    return _47(_49.value0);
                };
                if (_49 instanceof Valid) {
                    return _48(_49.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var invalid = Invalid.create;
    var functorV = new Prelude.Functor(function (_52) {
        return function (_53) {
            if (_53 instanceof Invalid) {
                return new Invalid(_53.value0);
            };
            if (_53 instanceof Valid) {
                return new Valid(_52(_53.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var applyV = function (__dict_Semigroup_18) {
        return new Prelude.Apply(function (_54) {
            return function (_55) {
                if (_54 instanceof Invalid && _55 instanceof Invalid) {
                    return new Invalid(Prelude["<>"](__dict_Semigroup_18)(_54.value0)(_55.value0));
                };
                if (_54 instanceof Invalid) {
                    return new Invalid(_54.value0);
                };
                if (_55 instanceof Invalid) {
                    return new Invalid(_55.value0);
                };
                if (_54 instanceof Valid && _55 instanceof Valid) {
                    return new Valid(_54.value0(_55.value0));
                };
                throw new Error("Failed pattern match");
            };
        }, function () {
            return functorV;
        });
    };
    var applicativeV = function (__dict_Semigroup_19) {
        return new Prelude.Applicative(function () {
            return applyV(__dict_Semigroup_19);
        }, Valid.create);
    };
    return {
        applicativeV: applicativeV, 
        applyV: applyV, 
        functorV: functorV, 
        invalid: invalid, 
        runV: runV
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function runFn2(fn) {  return function(a) {    return function(b) {      return fn(a, b);    };  };};
    function runFn3(fn) {  return function(a) {    return function(b) {      return function(c) {        return fn(a, b, c);      };    };  };};
    function runFn4(fn) {  return function(a) {    return function(b) {      return function(c) {        return function(d) {          return fn(a, b, c, d);        };      };    };  };};
    return {
        runFn2: runFn2, 
        runFn3: runFn3, 
        runFn4: runFn4
    };
})();
var PS = PS || {};
PS.Data_AddressBook = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function HomePhone() {

    };
    HomePhone.value = new HomePhone();
    function WorkPhone() {

    };
    WorkPhone.value = new WorkPhone();
    function CellPhone() {

    };
    CellPhone.value = new CellPhone();
    function OtherPhone() {

    };
    OtherPhone.value = new OtherPhone();
    var PhoneNumber = {
        create: function (value) {
            return value;
        }
    };
    var Address = {
        create: function (value) {
            return value;
        }
    };
    var Person = {
        create: function (value) {
            return value;
        }
    };
    var showPhoneType = new Prelude.Show(function (_68) {
        if (_68 instanceof HomePhone) {
            return "HomePhone";
        };
        if (_68 instanceof WorkPhone) {
            return "WorkPhone";
        };
        if (_68 instanceof CellPhone) {
            return "CellPhone";
        };
        if (_68 instanceof OtherPhone) {
            return "OtherPhone";
        };
        throw new Error("Failed pattern match");
    });
    var showPhoneNumber = new Prelude.Show(function (_69) {
        return "PhoneNumber " + ("{ type: " + (Prelude.show(showPhoneType)(_69.type) + (", number: " + (Prelude.show(Prelude.showString)(_69.number) + " }"))));
    });
    var showAddress = new Prelude.Show(function (_67) {
        return "Address " + ("{ street: " + (Prelude.show(Prelude.showString)(_67.street) + (", city: " + (Prelude.show(Prelude.showString)(_67.city) + (", state: " + (Prelude.show(Prelude.showString)(_67.state) + " }"))))));
    });
    var showPerson = new Prelude.Show(function (_70) {
        return "Person " + ("{ firstName: " + (Prelude.show(Prelude.showString)(_70.firstName) + (", lastName: " + (Prelude.show(Prelude.showString)(_70.lastName) + (", address: " + (Prelude.show(showAddress)(_70.address) + (", phones: " + (Prelude.show(Prelude.showArray(showPhoneNumber))(_70.phones) + " }"))))))));
    });
    var phoneNumber = function (ty) {
        return function (number) {
            return {
                type: ty, 
                number: number
            };
        };
    };
    var person = function (firstName) {
        return function (lastName) {
            return function (address_1) {
                return function (phones) {
                    return {
                        firstName: firstName, 
                        lastName: lastName, 
                        address: address_1, 
                        phones: phones
                    };
                };
            };
        };
    };
    var address = function (street) {
        return function (city) {
            return function (state) {
                return {
                    street: street, 
                    city: city, 
                    state: state
                };
            };
        };
    };
    return {
        Address: Address, 
        CellPhone: CellPhone, 
        HomePhone: HomePhone, 
        OtherPhone: OtherPhone, 
        Person: Person, 
        PhoneNumber: PhoneNumber, 
        WorkPhone: WorkPhone, 
        address: address, 
        person: person, 
        phoneNumber: phoneNumber, 
        showAddress: showAddress, 
        showPerson: showPerson, 
        showPhoneNumber: showPhoneNumber, 
        showPhoneType: showPhoneType
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function returnE(a) {  return function() {    return a;  };};
    function bindE(a) {  return function(f) {    return function() {      return f(a())();    };  };};
    function foreachE(as) {  return function(f) {    return function() {      for (var i = 0; i < as.length; i++) {        f(as[i])();      }    };  };};
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        applicativeEff: applicativeEff, 
        applyEff: applyEff, 
        bindE: bindE, 
        bindEff: bindEff, 
        foreachE: foreachE, 
        functorEff: functorEff, 
        monadEff: monadEff, 
        returnE: returnE
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Alert = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function alert(msg) {  return function() {    window.alert(msg);    return {};  };};
    return {
        alert: alert
    };
})();
var PS = PS || {};
PS.Debug_Trace = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function trace(s) {  return function() {    console.log(s);    return {};  };};
    var print = function (__dict_Show_20) {
        return function (o) {
            return trace(Prelude.show(__dict_Show_20)(o));
        };
    };
    return {
        print: print, 
        trace: trace
    };
})();
var PS = PS || {};
PS.Control_Apply = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $times$greater = function (__dict_Apply_39) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_39)(Prelude["<$>"](__dict_Apply_39["__superclass_Prelude.Functor_0"]())(Prelude["const"](Prelude.id(Prelude.categoryArr)))(a))(b);
            };
        };
    };
    return {
        "*>": $times$greater
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Left(value0) {
        this.value0 = value0;
    };
    Left.create = function (value0) {
        return new Left(value0);
    };
    function Right(value0) {
        this.value0 = value0;
    };
    Right.create = function (value0) {
        return new Right(value0);
    };
    var functorEither = new Prelude.Functor(function (_84) {
        return function (_85) {
            if (_85 instanceof Left) {
                return new Left(_85.value0);
            };
            if (_85 instanceof Right) {
                return new Right(_84(_85.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var either = function (_81) {
        return function (_82) {
            return function (_83) {
                if (_83 instanceof Left) {
                    return _81(_83.value0);
                };
                if (_83 instanceof Right) {
                    return _82(_83.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var applyEither = new Prelude.Apply(function (_86) {
        return function (_87) {
            if (_86 instanceof Left) {
                return new Left(_86.value0);
            };
            if (_86 instanceof Right) {
                return Prelude["<$>"](functorEither)(_86.value0)(_87);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var bindEither = new Prelude.Bind(either(function (e) {
        return function (_) {
            return new Left(e);
        };
    })(function (a) {
        return function (f) {
            return f(a);
        };
    }), function () {
        return applyEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    var monadEither = new Prelude.Monad(function () {
        return applicativeEither;
    }, function () {
        return bindEither;
    });
    return {
        Left: Left, 
        Right: Right, 
        applicativeEither: applicativeEither, 
        applyEither: applyEither, 
        bindEither: bindEither, 
        either: either, 
        functorEither: functorEither, 
        monadEither: monadEither
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Nothing() {

    };
    Nothing.value = new Nothing();
    function Just(value0) {
        this.value0 = value0;
    };
    Just.create = function (value0) {
        return new Just(value0);
    };
    var functorMaybe = new Prelude.Functor(function (_98) {
        return function (_99) {
            if (_99 instanceof Just) {
                return new Just(_98(_99.value0));
            };
            return Nothing.value;
        };
    });
    return {
        Just: Just, 
        Nothing: Nothing, 
        functorMaybe: functorMaybe
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    function length (xs) {  return xs.length;};
    function append (l1) {  return function (l2) {    return l1.concat(l2);  };};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    var semigroupArray = new Prelude.Semigroup(append);
    var functorArray = new Prelude.Functor(map);
    return {
        append: append, 
        functorArray: functorArray, 
        length: length, 
        map: map, 
        semigroupArray: semigroupArray
    };
})();
var PS = PS || {};
PS.Data_Foreign = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Function = PS.Data_Function;
    var Data_Either = PS.Data_Either;
    function TypeMismatch(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    TypeMismatch.create = function (value0) {
        return function (value1) {
            return new TypeMismatch(value0, value1);
        };
    };
    function ErrorAtIndex(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorAtIndex.create = function (value0) {
        return function (value1) {
            return new ErrorAtIndex(value0, value1);
        };
    };
    function ErrorAtProperty(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorAtProperty.create = function (value0) {
        return function (value1) {
            return new ErrorAtProperty(value0, value1);
        };
    };
    function JSONError(value0) {
        this.value0 = value0;
    };
    JSONError.create = function (value0) {
        return new JSONError(value0);
    };
    function parseJSONImpl(left, right, str) {  try {    return right(JSON.parse(str));  } catch (e) {    return left(e.toString());  } };
    function toForeign(value) {  return value;};
    function unsafeFromForeign(value) {  return value;};
    function typeOf(value) {  return typeof value;};
    function tagOf(value) {  return Object.prototype.toString.call(value).slice(8, -1);};
    function isNull(value) {  return value === null;};
    function isUndefined(value) {  return value === undefined;};
    var unsafeReadPrim = function (_136) {
        return function (_137) {
            if (tagOf(_137) === _136) {
                return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_137));
            };
            return new Data_Either.Left(new TypeMismatch(_136, tagOf(_137)));
        };
    };
    var showForeignError = new Prelude.Show(function (_139) {
        if (_139 instanceof TypeMismatch) {
            return "Type mismatch: expected " + (_139.value0 + (", found " + _139.value1));
        };
        if (_139 instanceof ErrorAtIndex) {
            return "Error at array index " + (Prelude.show(Prelude.showNumber)(_139.value0) + (": " + Prelude.show(showForeignError)(_139.value1)));
        };
        if (_139 instanceof ErrorAtProperty) {
            return "Error at property " + (Prelude.show(Prelude.showString)(_139.value0) + (": " + Prelude.show(showForeignError)(_139.value1)));
        };
        if (_139 instanceof JSONError) {
            return "JSON error: " + _139.value0;
        };
        throw new Error("Failed pattern match");
    });
    var readString = unsafeReadPrim("String");
    var parseJSON = function (json) {
        return parseJSONImpl(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(JSONError.create), Data_Either.Right.create, json);
    };
    return {
        ErrorAtIndex: ErrorAtIndex, 
        ErrorAtProperty: ErrorAtProperty, 
        JSONError: JSONError, 
        TypeMismatch: TypeMismatch, 
        isNull: isNull, 
        isUndefined: isUndefined, 
        parseJSON: parseJSON, 
        readString: readString, 
        showForeignError: showForeignError, 
        tagOf: tagOf, 
        toForeign: toForeign, 
        typeOf: typeOf, 
        unsafeFromForeign: unsafeFromForeign
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_DOM = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    function body() {  return document.body;};
    function createElement(name) {  return function() {    return document.createElement(name);  };};
    function querySelectorImpl(r, f, s) {  return function() {    var result = document.querySelector(s);    return result ? f(result) : r;  };};
    function appendChild(child) {  return function(node) {    return function() {      node.appendChild(child);      return node;    };  };};
    function addClass(className) {  return function(node) {    return function() {      node.classList.add(className);      return node;    };  };};
    function setText(text) {  return function(node) {    return function() {      node.textContent = text;      return node;    };  };};
    function getValue(node) {  return function() {    return node.value;  };};
    function setValue(value) {  return function(node) {    return function() {      node.value = value;      return node;    };  };};
    function setInnerHTML(html) {  return function(node) {    return function() {      node.innerHTML = html;      return node;    };  };};
    function addEventListener(name) {  return function(handler) {    return function(node) {      return function() {        node.addEventListener(name, function(e) {          handler();          e.preventDefault();        });      };    };  };};
    var querySelector = function (s) {
        return querySelectorImpl(Data_Maybe.Nothing.value, Data_Maybe.Just.create, s);
    };
    return {
        addClass: addClass, 
        addEventListener: addEventListener, 
        appendChild: appendChild, 
        body: body, 
        createElement: createElement, 
        getValue: getValue, 
        querySelector: querySelector, 
        querySelectorImpl: querySelectorImpl, 
        setInnerHTML: setInnerHTML, 
        setText: setText, 
        setValue: setValue
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Storage = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function setItem(key) {  return function(value) {    return function() {      window.localStorage.setItem(key, value);    };  };};
    function getItem(key) {  return function() {    return window.localStorage.getItem(key);  }};
    return {
        getItem: getItem, 
        setItem: setItem
    };
})();
var PS = PS || {};
PS.Data_Foreign_Index = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Foreign = PS.Data_Foreign;
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    function Index($bang, errorAt, hasOwnProperty, hasProperty) {
        this["!"] = $bang;
        this.errorAt = errorAt;
        this.hasOwnProperty = hasOwnProperty;
        this.hasProperty = hasProperty;
    };
    function unsafeReadPropImpl(f, s, key, value) {   if (value && typeof value === 'object') {    return s(value[key]);  } else {    return f;  }};
    function unsafeHasOwnProperty(prop, value) {  return value.hasOwnProperty(prop);};
    function unsafeHasProperty(prop, value) {  return prop in value;};
    var $bang = function (dict) {
        return dict["!"];
    };
    var unsafeReadProp = function (k) {
        return function (value) {
            return unsafeReadPropImpl(new Data_Either.Left(new Data_Foreign.TypeMismatch("object", Data_Foreign.typeOf(value))), Prelude.pure(Data_Either.applicativeEither), k, value);
        };
    };
    var prop = unsafeReadProp;
    var hasPropertyImpl = function (_142) {
        return function (_143) {
            if (Data_Foreign.isNull(_143)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_143)) {
                return false;
            };
            if (Data_Foreign.typeOf(_143) === "object" || Data_Foreign.typeOf(_143) === "function") {
                return unsafeHasProperty(_142, _143);
            };
            return false;
        };
    };
    var hasOwnPropertyImpl = function (_140) {
        return function (_141) {
            if (Data_Foreign.isNull(_141)) {
                return false;
            };
            if (Data_Foreign.isUndefined(_141)) {
                return false;
            };
            if (Data_Foreign.typeOf(_141) === "object" || Data_Foreign.typeOf(_141) === "function") {
                return unsafeHasOwnProperty(_140, _141);
            };
            return false;
        };
    };
    var indexString = new Index(Prelude.flip(prop), Data_Foreign.ErrorAtProperty.create, hasOwnPropertyImpl, hasPropertyImpl);
    var errorAt = function (dict) {
        return dict.errorAt;
    };
    return {
        "!": $bang, 
        Index: Index, 
        errorAt: errorAt, 
        indexString: indexString, 
        prop: prop
    };
})();
var PS = PS || {};
PS.Data_JSON = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function stringify(x) {  return JSON.stringify(x);};
    return {
        stringify: stringify
    };
})();
var PS = PS || {};
PS.Data_Foreign_Null = (function () {
    "use strict";
    var Data_Foreign = PS.Data_Foreign;
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    var Data_Maybe = PS.Data_Maybe;
    var Null = {
        create: function (value) {
            return value;
        }
    };
    var runNull = function (_145) {
        return _145;
    };
    var readNull = function (_146) {
        return function (_147) {
            if (Data_Foreign.isNull(_147)) {
                return Prelude.pure(Data_Either.applicativeEither)(Data_Maybe.Nothing.value);
            };
            return Prelude["<$>"](Data_Either.functorEither)(Prelude["<<<"](Prelude.semigroupoidArr)(Null.create)(Data_Maybe.Just.create))(_146(_147));
        };
    };
    return {
        Null: Null, 
        readNull: readNull, 
        runNull: runNull
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var mempty = function (dict) {
        return dict.mempty;
    };
    return {
        mempty: mempty
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Data_Monoid = PS.Data_Monoid;
    var Prelude = PS.Prelude;
    var Control_Apply = PS.Control_Apply;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Maybe = PS.Data_Maybe;
    function Foldable(foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    function foldrArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = xs.length - 1; i >= 0; --i) {        acc = f(xs[i])(acc);      }      return acc;    }  }};
    function foldlArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = 0, len = xs.length; i < len; ++i) {        acc = f(acc)(xs[i]);      }      return acc;    }  }};
    var foldr = function (dict) {
        return dict.foldr;
    };
    var foldableMaybe = new Foldable(function (__dict_Monoid_114) {
        return function (_263) {
            return function (_264) {
                if (_264 instanceof Data_Maybe.Nothing) {
                    return Data_Monoid.mempty(__dict_Monoid_114);
                };
                if (_264 instanceof Data_Maybe.Just) {
                    return _263(_264.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_260) {
        return function (_261) {
            return function (_262) {
                if (_262 instanceof Data_Maybe.Nothing) {
                    return _261;
                };
                if (_262 instanceof Data_Maybe.Just) {
                    return _260(_261)(_262.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    }, function (_257) {
        return function (_258) {
            return function (_259) {
                if (_259 instanceof Data_Maybe.Nothing) {
                    return _258;
                };
                if (_259 instanceof Data_Maybe.Just) {
                    return _257(_259.value0)(_258);
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var foldableArray = new Foldable(function (__dict_Monoid_116) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_116["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_116))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    return {
        Foldable: Foldable, 
        foldableArray: foldableArray, 
        foldableMaybe: foldableMaybe, 
        foldlArray: foldlArray, 
        foldr: foldr, 
        foldrArray: foldrArray
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Data_Function = PS.Data_Function;
    var Data_Char = PS.Data_Char;
    var Prelude = PS.Prelude;
    
    function length(s) {
      return s.length;
    }
    ;
    return {
        length: length
    };
})();
var PS = PS || {};
PS.Data_String_Regex = (function () {
    "use strict";
    var Data_String = PS.Data_String;
    var Data_Function = PS.Data_Function;
    var Prelude = PS.Prelude;
    
  function regex$prime(s1) {
    return function(s2) {
      return new RegExp(s1, s2);
    };
  }
  ;
    
  function source(r) {
    return r.source;
  }
  ;
    
  function flags(r) {
    return {
      multiline: r.multiline,
      ignoreCase: r.ignoreCase,
      global: r.global,
      sticky: !!r.sticky,
      unicode: !!r.unicode
    };
  }
  ;
    
  function test(r) {
    return function(s) {
      return r.test(s);
    };
  }
  ;
    var renderFlags = function (flags_1) {
        return (flags_1.global ? "g" : "") + ((flags_1.ignoreCase ? "i" : "") + ((flags_1.multiline ? "m" : "") + ((flags_1.sticky ? "y" : "") + (flags_1.unicode ? "u" : ""))));
    };
    var regex = function (source_1) {
        return function (flags_1) {
            return regex$prime(source_1)(renderFlags(flags_1));
        };
    };
    return {
        flags: flags, 
        regex: regex, 
        renderFlags: renderFlags, 
        source: source, 
        test: test
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Foldable = PS.Data_Foldable;
    function Traversable(__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var traversableMaybe = new Traversable(function () {
        return Data_Foldable.foldableMaybe;
    }, function () {
        return Data_Maybe.functorMaybe;
    }, function (__dict_Applicative_138) {
        return function (_304) {
            if (_304 instanceof Data_Maybe.Nothing) {
                return Prelude.pure(__dict_Applicative_138)(Data_Maybe.Nothing.value);
            };
            if (_304 instanceof Data_Maybe.Just) {
                return Prelude["<$>"]((__dict_Applicative_138["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Maybe.Just.create)(_304.value0);
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_137) {
        return function (_302) {
            return function (_303) {
                if (_303 instanceof Data_Maybe.Nothing) {
                    return Prelude.pure(__dict_Applicative_137)(Data_Maybe.Nothing.value);
                };
                if (_303 instanceof Data_Maybe.Just) {
                    return Prelude["<$>"]((__dict_Applicative_137["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Maybe.Just.create)(_302(_303.value0));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_142) {
        return function (_295) {
            if (_295.length === 0) {
                return Prelude.pure(__dict_Applicative_142)([  ]);
            };
            if (_295.length >= 1) {
                var _398 = _295.slice(1);
                return Prelude["<*>"](__dict_Applicative_142["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_142["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_295[0]))(sequence(traversableArray)(__dict_Applicative_142)(_398));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_141) {
        return function (_293) {
            return function (_294) {
                if (_294.length === 0) {
                    return Prelude.pure(__dict_Applicative_141)([  ]);
                };
                if (_294.length >= 1) {
                    var _402 = _294.slice(1);
                    return Prelude["<*>"](__dict_Applicative_141["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_141["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_293(_294[0])))(traverse(traversableArray)(__dict_Applicative_141)(_293)(_402));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    return {
        Traversable: Traversable, 
        sequence: sequence, 
        traversableArray: traversableArray, 
        traversableMaybe: traversableMaybe, 
        traverse: traverse
    };
})();
var PS = PS || {};
PS.Data_AddressBook_Validation = (function () {
    "use strict";
    var Data_Validation = PS.Data_Validation;
    var Prelude = PS.Prelude;
    var Data_String = PS.Data_String;
    var Data_String_Regex = PS.Data_String_Regex;
    var Data_AddressBook = PS.Data_AddressBook;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array = PS.Data_Array;
    var Control_Apply = PS.Control_Apply;
    var Data_Either = PS.Data_Either;
    var phoneNumberRegex = Data_String_Regex.regex("^\\d{3}-\\d{3}-\\d{4}$")({
        unicode: false, 
        sticky: false, 
        multiline: false, 
        ignoreCase: false, 
        global: false
    });
    var nonEmpty = function (_308) {
        return function (_309) {
            if (_309 === "") {
                return Data_Validation.invalid([ "Field '" + (_308 + "' cannot be empty") ]);
            };
            return Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(Prelude.unit);
        };
    };
    var matches = function (_315) {
        return function (_316) {
            return function (_317) {
                if (Data_String_Regex.test(_316)(_317)) {
                    return Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(Prelude.unit);
                };
                return Data_Validation.invalid([ "Field '" + (_315 + "' did not match the required format") ]);
            };
        };
    };
    var validatePhoneNumber = function (_319) {
        return Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<$>"](Data_Validation.functorV)(Data_AddressBook.phoneNumber)(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_319.type)))(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(matches("Number")(phoneNumberRegex)(_319.number))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_319.number)));
    };
    var lengthIs = function (_312) {
        return function (_313) {
            return function (_314) {
                if (Data_String.length(_314) !== _313) {
                    return Data_Validation.invalid([ "Field '" + (_312 + ("' must have length " + Prelude.show(Prelude.showNumber)(_313))) ]);
                };
                return Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(Prelude.unit);
            };
        };
    };
    var validateAddress = function (_318) {
        return Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<$>"](Data_Validation.functorV)(Data_AddressBook.address)(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(nonEmpty("Street")(_318.street))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_318.street))))(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(nonEmpty("City")(_318.city))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_318.city))))(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(lengthIs("State")(2)(_318.state))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_318.state)));
    };
    var arrayNonEmpty = function (_310) {
        return function (_311) {
            if (_311.length === 0) {
                return Data_Validation.invalid([ "Field '" + (_310 + "' must contain at least one value") ]);
            };
            return Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(Prelude.unit);
        };
    };
    var validatePerson = function (_320) {
        return Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<*>"](Data_Validation.applyV(Data_Array.semigroupArray))(Prelude["<$>"](Data_Validation.functorV)(Data_AddressBook.person)(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(nonEmpty("First Name")(_320.firstName))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_320.firstName))))(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(nonEmpty("Last Name")(_320.lastName))(Prelude.pure(Data_Validation.applicativeV(Data_Array.semigroupArray))(_320.lastName))))(validateAddress(_320.address)))(Control_Apply["*>"](Data_Validation.applyV(Data_Array.semigroupArray))(arrayNonEmpty("Phone Numbers")(_320.phones))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Validation.applicativeV(Data_Array.semigroupArray))(validatePhoneNumber)(_320.phones)));
    };
    var validatePerson$prime = function (p) {
        return Data_Validation.runV(Data_Either.Left.create)(Data_Either.Right.create)(validatePerson(p));
    };
    return {
        arrayNonEmpty: arrayNonEmpty, 
        lengthIs: lengthIs, 
        matches: matches, 
        nonEmpty: nonEmpty, 
        phoneNumberRegex: phoneNumberRegex, 
        validateAddress: validateAddress, 
        validatePerson: validatePerson, 
        "validatePerson'": validatePerson$prime, 
        validatePhoneNumber: validatePhoneNumber
    };
})();
var PS = PS || {};
PS.Data_Foreign_Class = (function () {
    "use strict";
    var Data_Foreign = PS.Data_Foreign;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array = PS.Data_Array;
    var Data_Foreign_Null = PS.Data_Foreign_Null;
    var Data_Foreign_Undefined = PS.Data_Foreign_Undefined;
    var Data_Foreign_NullOrUndefined = PS.Data_Foreign_NullOrUndefined;
    var Data_Either = PS.Data_Either;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    var Prelude = PS.Prelude;
    function IsForeign(read) {
        this.read = read;
    };
    var stringIsForeign = new IsForeign(Data_Foreign.readString);
    var read = function (dict) {
        return dict.read;
    };
    var readJSON = function (__dict_IsForeign_146) {
        return function (json) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign.parseJSON(json))(read(__dict_IsForeign_146));
        };
    };
    var readWith = function (__dict_IsForeign_147) {
        return function (f) {
            return function (value) {
                return Data_Either.either(Prelude["<<<"](Prelude.semigroupoidArr)(Data_Either.Left.create)(f))(Data_Either.Right.create)(read(__dict_IsForeign_147)(value));
            };
        };
    };
    var readProp = function (__dict_IsForeign_148) {
        return function (__dict_Index_149) {
            return function (prop) {
                return function (value) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Index["!"](__dict_Index_149)(value)(prop))(readWith(__dict_IsForeign_148)(Data_Foreign_Index.errorAt(__dict_Index_149)(prop)));
                };
            };
        };
    };
    var nullIsForeign = function (__dict_IsForeign_152) {
        return new IsForeign(Data_Foreign_Null.readNull(read(__dict_IsForeign_152)));
    };
    return {
        IsForeign: IsForeign, 
        nullIsForeign: nullIsForeign, 
        read: read, 
        readJSON: readJSON, 
        readProp: readProp, 
        readWith: readWith, 
        stringIsForeign: stringIsForeign
    };
})();
var PS = PS || {};
PS.Data_AddressBook_UI = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff_DOM = PS.Control_Monad_Eff_DOM;
    var Data_Foreign_Class = PS.Data_Foreign_Class;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Debug_Trace = PS.Debug_Trace;
    var Data_AddressBook = PS.Data_AddressBook;
    var Data_Traversable = PS.Data_Traversable;
    var Data_AddressBook_Validation = PS.Data_AddressBook_Validation;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Either = PS.Data_Either;
    var valueOf = function (sel) {
        return function __do() {
            var _6 = Control_Monad_Eff_DOM.querySelector(sel)();
            return (function () {
                if (_6 instanceof Data_Maybe.Nothing) {
                    return Prelude["return"](Control_Monad_Eff.monadEff)("");
                };
                if (_6 instanceof Data_Maybe.Just) {
                    return function __do() {
                        var _5 = Control_Monad_Eff_DOM.getValue(_6.value0)();
                        var _419 = Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)(_5);
                        if (_419 instanceof Data_Either.Right) {
                            return _419.value0;
                        };
                        return "";
                    };
                };
                throw new Error("Failed pattern match");
            })()();
        };
    };
    var validateControls = function __do() {
        Debug_Trace.trace("Running validators")();
        var _11 = Prelude["<*>"](Control_Monad_Eff.applyEff)(Prelude["<*>"](Control_Monad_Eff.applyEff)(Prelude["<*>"](Control_Monad_Eff.applyEff)(Prelude["<$>"](Control_Monad_Eff.functorEff)(Data_AddressBook.person)(valueOf("#inputFirstName")))(valueOf("#inputLastName")))(Prelude["<*>"](Control_Monad_Eff.applyEff)(Prelude["<*>"](Control_Monad_Eff.applyEff)(Prelude["<$>"](Control_Monad_Eff.functorEff)(Data_AddressBook.address)(valueOf("#inputStreet")))(valueOf("#inputCity")))(valueOf("#inputState"))))(Data_Traversable.sequence(Data_Traversable.traversableArray)(Control_Monad_Eff.applicativeEff)([ Prelude["<$>"](Control_Monad_Eff.functorEff)(Data_AddressBook.phoneNumber(Data_AddressBook.HomePhone.value))(valueOf("#inputHomePhone")), Prelude["<$>"](Control_Monad_Eff.functorEff)(Data_AddressBook.phoneNumber(Data_AddressBook.CellPhone.value))(valueOf("#inputCellPhone")) ]))();
        return Data_AddressBook_Validation["validatePerson'"](_11);
    };
    var displayValidationErrors = function (errs) {
        return function __do() {
            var _10 = Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.createElement("div"))(Control_Monad_Eff_DOM.addClass("alert")))(Control_Monad_Eff_DOM.addClass("alert-danger"))();
            var _9 = Control_Monad_Eff_DOM.createElement("ul")();
            Control_Monad_Eff_DOM.appendChild(_9)(_10)();
            Control_Monad_Eff.foreachE(errs)(function (err) {
                return function __do() {
                    var _7 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.createElement("li"))(Control_Monad_Eff_DOM.setText(err))();
                    Control_Monad_Eff_DOM.appendChild(_7)(_9)();
                    return Prelude.unit;
                };
            })();
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.querySelector("#validationErrors"))(function (_8) {
                if (_8 instanceof Data_Maybe.Just) {
                    return function __do() {
                        Control_Monad_Eff_DOM.appendChild(_10)(_8.value0)();
                        return Prelude.unit;
                    };
                };
                throw new Error("Failed pattern match");
            })();
        };
    };
    var validateAndUpdateUI = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.querySelector("#validationErrors"))(function (_13) {
        if (_13 instanceof Data_Maybe.Just) {
            return function __do() {
                Control_Monad_Eff_DOM.setInnerHTML("")(_13.value0)();
                var _12 = validateControls();
                (function () {
                    if (_12 instanceof Data_Either.Left) {
                        return displayValidationErrors(_12.value0);
                    };
                    if (_12 instanceof Data_Either.Right) {
                        return Debug_Trace.print(Data_AddressBook.showPerson)(_12.value0);
                    };
                    throw new Error("Failed pattern match");
                })()();
                return Prelude.unit;
            };
        };
        throw new Error("Failed pattern match");
    });
    var setupEventHandlers = function __do() {
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.body)(Control_Monad_Eff_DOM.addEventListener("change")(validateAndUpdateUI))();
        return Prelude.unit;
    };
    return {
        displayValidationErrors: displayValidationErrors, 
        setupEventHandlers: setupEventHandlers, 
        validateAndUpdateUI: validateAndUpdateUI, 
        validateControls: validateControls, 
        valueOf: valueOf
    };
})();
var PS = PS || {};
PS.Main = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign_Class = PS.Data_Foreign_Class;
    var Control_Monad_Eff_DOM = PS.Control_Monad_Eff_DOM;
    var Control_Monad_Eff_Storage = PS.Control_Monad_Eff_Storage;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Foreign_Null = PS.Data_Foreign_Null;
    var Control_Monad_Eff_Alert = PS.Control_Monad_Eff_Alert;
    var Debug_Trace = PS.Debug_Trace;
    var Data_AddressBook_UI = PS.Data_AddressBook_UI;
    var Data_Array = PS.Data_Array;
    var Data_JSON = PS.Data_JSON;
    var Data_Foreign = PS.Data_Foreign;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Data_Maybe = PS.Data_Maybe;
    var Data_AddressBook = PS.Data_AddressBook;
    var Data_Either = PS.Data_Either;
    var Data_Foreign_Index = PS.Data_Foreign_Index;
    var FormData = {
        create: function (value) {
            return value;
        }
    };
    var updateForm = function (sel) {
        return function (value) {
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.querySelector(sel))(function (_21) {
                if (_21 instanceof Data_Maybe.Just) {
                    return function __do() {
                        Control_Monad_Eff_DOM.setValue(value)(_21.value0)();
                        return Prelude.unit;
                    };
                };
                throw new Error("Failed pattern match");
            });
        };
    };
    var toFormData = function (_321) {
        if (_321.phones.length === 2) {
            return {
                firstName: _321.firstName, 
                lastName: _321.lastName, 
                street: _321.address.street, 
                city: _321.address.city, 
                state: _321.address.state, 
                homePhone: (_321.phones[0]).number, 
                cellPhone: (_321.phones[1]).number
            };
        };
        throw new Error("Failed pattern match");
    };
    var validateAndSaveEntry = function __do() {
        Debug_Trace.trace("Running validators")();
        var _24 = Data_AddressBook_UI.validateControls();
        (function () {
            if (_24 instanceof Data_Either.Left) {
                return Control_Monad_Eff_Alert.alert("There are " + (Prelude.show(Prelude.showNumber)(Data_Array.length(_24.value0)) + " validation errors."));
            };
            if (_24 instanceof Data_Either.Right) {
                return function __do() {
                    Control_Monad_Eff_Storage.setItem("person")(Data_JSON.stringify(Data_Foreign.toForeign(toFormData(_24.value0))))();
                    return Control_Monad_Eff_Alert.alert("Saved")();
                };
            };
            throw new Error("Failed pattern match");
        })()();
        return Prelude.unit;
    };
    var formDataIsForeign = new Data_Foreign_Class.IsForeign(function (value) {
        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("firstName")(value))(function (_20) {
            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("lastName")(value))(function (_19) {
                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("street")(value))(function (_18) {
                    return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("city")(value))(function (_17) {
                        return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("state")(value))(function (_16) {
                            return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("homePhone")(value))(function (_15) {
                                return Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.readProp(Data_Foreign_Class.stringIsForeign)(Data_Foreign_Index.indexString)("cellPhone")(value))(function (_14) {
                                    return Prelude["return"](Data_Either.monadEither)({
                                        firstName: _20, 
                                        lastName: _19, 
                                        street: _18, 
                                        city: _17, 
                                        state: _16, 
                                        homePhone: _15, 
                                        cellPhone: _14
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    });
    var loadSavedData = function __do() {
        var _23 = Control_Monad_Eff_Storage.getItem("person")();
        return (function () {
            var savedData = Prelude[">>="](Data_Either.bindEither)(Data_Foreign_Class.read(Data_Foreign_Class.nullIsForeign(Data_Foreign_Class.stringIsForeign))(_23))(function (_22) {
                return Data_Traversable.traverse(Data_Traversable.traversableMaybe)(Data_Either.applicativeEither)(Data_Foreign_Class.readJSON(formDataIsForeign))(Data_Foreign_Null.runNull(_22));
            });
            if (savedData instanceof Data_Either.Left) {
                return Control_Monad_Eff_Alert.alert("Unable to read saved form data: " + Prelude.show(Data_Foreign.showForeignError)(savedData.value0));
            };
            if (savedData instanceof Data_Either.Right && savedData.value0 instanceof Data_Maybe.Nothing) {
                return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
            };
            if (savedData instanceof Data_Either.Right && savedData.value0 instanceof Data_Maybe.Just) {
                return function __do() {
                    updateForm("#inputFirstName")(savedData.value0.value0.firstName)();
                    updateForm("#inputLastName")(savedData.value0.value0.lastName)();
                    updateForm("#inputStreet")(savedData.value0.value0.street)();
                    updateForm("#inputCity")(savedData.value0.value0.city)();
                    updateForm("#inputState")(savedData.value0.value0.state)();
                    updateForm("#inputHomePhone")(savedData.value0.value0.homePhone)();
                    updateForm("#inputCellPhone")(savedData.value0.value0.cellPhone)();
                    return Prelude.unit;
                };
            };
            throw new Error("Failed pattern match");
        })()();
    };
    var main = function __do() {
        Debug_Trace.trace("Loading data from local storage")();
        loadSavedData();
        Debug_Trace.trace("Attaching event handlers")();
        Data_AddressBook_UI.setupEventHandlers();
        return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_DOM.querySelector("#saveButton"))(function (_25) {
            if (_25 instanceof Data_Maybe.Just) {
                return function __do() {
                    Control_Monad_Eff_DOM.addEventListener("click")(validateAndSaveEntry)(_25.value0)();
                    return Prelude.unit;
                };
            };
            throw new Error("Failed pattern match");
        })();
    };
    return {
        FormData: FormData, 
        formDataIsForeign: formDataIsForeign, 
        loadSavedData: loadSavedData, 
        main: main, 
        toFormData: toFormData, 
        updateForm: updateForm, 
        validateAndSaveEntry: validateAndSaveEntry
    };
})();
